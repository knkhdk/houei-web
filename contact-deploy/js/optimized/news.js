document.addEventListener('DOMContentLoaded',function(){loadPostedNews();const filterButtons=document.querySelectorAll('.filter-btn');filterButtons.forEach(button=>{button.addEventListener('click',function(){const category=this.getAttribute('data-category');filterButtons.forEach(btn=> btn.classList.remove('active'));this.classList.add('active');const timelineItems=document.querySelectorAll('.timeline-item');timelineItems.forEach(item=>{if (category==='all' || item.getAttribute('data-category')===category){item.style.display='flex';item.style.opacity='0';setTimeout(()=>{item.style.opacity='1';},50);}else{item.style.opacity='0';setTimeout(()=>{item.style.display='none';},300);}});});});const pageButtons=document.querySelectorAll('.page-btn');pageButtons.forEach(button=>{button.addEventListener('click',function(e){e.preventDefault();pageButtons.forEach(btn=> btn.classList.remove('active'));this.classList.add('active');console.log('ページ切り替え:',this.textContent);});});const timelineItems=document.querySelectorAll('.timeline-item');timelineItems.forEach(item=>{item.addEventListener('mouseenter',function(){this.style.transform='translateY(-2px)';});item.addEventListener('mouseleave',function(){this.style.transform='translateY(0)';});});const internalLinks=document.querySelectorAll('a[href^="#"]');internalLinks.forEach(link=>{link.addEventListener('click',function(e){e.preventDefault();const targetId=this.getAttribute('href').substring(1);const targetElement=document.getElementById(targetId);if (targetElement){targetElement.scrollIntoView({behavior: 'smooth',block: 'start'});}});});function loadPostedNews(){try{const newsData=JSON.parse(localStorage.getItem('newsData') || '[]');const newsTimeline=document.querySelector('.news-timeline');if (newsData.length > 0){const sortedNewsData=newsData .filter(news=> news.status==='published') .sort((a,b)=>{const dateA=new Date(a.date);const dateB=new Date(b.date);return dateB-dateA;});newsTimeline.innerHTML='';sortedNewsData.forEach(news=>{const newsElement=createTimelineElement(news);newsTimeline.appendChild(newsElement);});initializeTimeline();}}catch (error){console.error('Error loading news from localStorage:',error);}}function exportNewsData(){try{const newsData=JSON.parse(localStorage.getItem('newsData') || '[]');if (newsData.length > 0){const dataStr=JSON.stringify(newsData,null,2);const blob=new Blob([dataStr],{type: 'application/json'});const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download='news-data.json';link.style.display='none';document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);alert('データをエクスポートしました');}else{alert('エクスポートするデータがありません');}}catch (error){console.error('Export error:',error);alert('エクスポートに失敗しました');}}function createTimelineElement(news){const dateObj=new Date(news.date);const day=dateObj.getDate();const month=dateObj.getMonth()+1;const year=dateObj.getFullYear();const newsElement=document.createElement('div');newsElement.className='timeline-item';newsElement.setAttribute('data-category',news.category);newsElement.setAttribute('data-id',news.id);let detailsHTML='';if (news.details){Object.values(news.details).forEach(detail=>{if (detail.label && detail.value){detailsHTML+=`<p><strong>${detail.label}:</strong> ${detail.value}</p>`;}});}let imageHTML='';if (news.image){imageHTML=` <div class="timeline-image"> <img src="${news.image}" alt="${news.title}" onerror="this.style.display='none'"> </div> `;}newsElement.innerHTML=` <div class="timeline-date"> <span class="timeline-day">${day}</span> <span class="timeline-month">${year}.${month.toString().padStart(2,'0')}</span> </div> <div class="timeline-content"> <span class="timeline-category">${news.category}</span> <h3>${news.title}</h3> <p>${news.summary}</p> <p>${news.content}</p> ${imageHTML}${detailsHTML ? `<div class="timeline-details">${detailsHTML}</div>` : ''}<div class="timeline-link"> <a href="detail.html?id=${news.id}" class="btn btn-primary">詳細を見る</a> </div> </div> `;return newsElement;}function initializeTimeline(){const timelineItems=document.querySelectorAll('.timeline-item');timelineItems.forEach((item,index)=>{item.style.opacity='0';item.style.transform='translateY(20px)';setTimeout(()=>{item.style.transition='all 0.6s ease';item.style.opacity='1';item.style.transform='translateY(0)';},index*100);});}});