(function(){'use strict';const isPreview=window.location.hostname==='localhost' || window.location.hostname==='127.0.0.1' || window.location.protocol==='file:';if (isPreview){console.log('プレビュー環境を検出: ちらつき軽減を適用');document.addEventListener('DOMContentLoaded',function(){optimizeForPreview();});window.addEventListener('load',function(){optimizeForPreview();});}function optimizeForPreview(){const hero=document.querySelector('.hero');if (hero){const existingInterval=window.slideShowInterval;if (existingInterval){clearInterval(existingInterval);window.slideShowInterval=setInterval(()=>{if (typeof window.changeBackgroundImage==='function'){window.changeBackgroundImage();}},8000);}}const style=document.createElement('style');style.textContent=` .hero{transition: background-image 0.3s ease-in-out !important;will-change: background-image !important;backface-visibility: hidden !important;transform: translateZ(0) !important;}.hero::before{transition: opacity 0.2s ease-in-out !important;}img{backface-visibility: hidden !important;transform: translateZ(0) !important;}*{-webkit-font-smoothing: antialiased !important;-moz-osx-font-smoothing: grayscale !important;}`;document.head.appendChild(style);optimizeImagePreloading();optimizeScrollPerformance();}function optimizeImagePreloading(){const criticalImages=[ 'images/top/logo.png','images/top/top1.jpg','images/top/top2.jpg','images/top/top3.jpg' ];criticalImages.forEach(src=>{const link=document.createElement('link');link.rel='preload';link.as='image';link.href=src;document.head.appendChild(link);});}function optimizeScrollPerformance(){let ticking=false;function updateOnScroll(){ticking=false;}function requestTick(){if (!ticking){requestAnimationFrame(updateOnScroll);ticking=true;}}window.addEventListener('scroll',requestTick,{passive: true});}window.optimizeForPreview=optimizeForPreview;})();